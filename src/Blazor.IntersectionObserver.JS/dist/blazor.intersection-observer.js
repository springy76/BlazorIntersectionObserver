!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.OBSERVER_ID_PREFIX="blazor_plugin_observer__";let t=1;const n=new Map;function o(e,t){return e.root===t.root&&e.rootMargin===t.rootMargin&&e.threshold===t.threshold}function r(r,i){null==i&&(i={});const u=function(e){let t=null;for(const[r,i]of n)if(o(e,i.options)){t={id:r,instance:i};break}return t}(i);if(null==u){const o=`${e.OBSERVER_ID_PREFIX}${t++}`,u=new IntersectionObserver(function(e){return t=>{if(!n.has(e))return;const{dotnetRef:o,elements:r}=n.get(e),i=t.reduce((e,t)=>{for(const[n,o]of r)o.has(t.target)&&(e[n]=(e[n]||[]).concat(t));return e},{});Object.keys(i).forEach(e=>{const t=i[e];o.invokeMethodAsync("OnCallback",e,t.map(s))})}}(o),i),c=new Map;return n.set(o,{dotnetRef:r,options:i,observer:u,elements:c}),{id:o,instance:n.get(o)}}return u}function i(e,t){let o=!1;return 0===t.elements.size&&(t.observer.disconnect(),n.delete(e),o=!0),o}function s(e){function t(e){return{X:e.x,Y:e.y,Width:e.width,Height:e.height,Top:e.top,Left:e.left,Bottom:e.bottom,Right:e.right}}return{IsIntersecting:e.isIntersecting,IntersectionRatio:e.intersectionRatio,Time:e.time,BoundingClientRect:t(e.boundingClientRect),IntersectionRect:t(e.intersectionRect),RootBounds:t(e.rootBounds)}}e.reset=function(){t=1,n.clear()},e.getObserverItems=function(){return n},e.create=function(e,t,n){const o=r(e,n),{instance:i}=o;return i.elements.set(t,new Set([])),o},e.observe=function(e,t,n,o){const{instance:i}=r(e,o);return function(e,t,n){const{elements:o,observer:r}=e,i=o.get(t);return null!=i?i.add(n):o.set(t,new Set([n])),r.observe(n),e}(i,t,n)},e.observeElement=function(e,t){const o=n.values();for(const n of o){const o=n.elements.get(e);if(null!=o&&!o.has(t)){n.observer.observe(t),o.add(t);break}}},e.unobserve=function(e,t){const o=n.values();let r=!1;for(const n of o){const o=n.elements.get(e);if(null!=o&&o.has(t)){n.observer.unobserve(t),o.delete(t),r=!0;break}}return r},e.disconnect=function(e){const t=n.entries();let o=!1;for(const[n,r]of t)if(r.elements.get(e)){r.elements.delete(e),i(n,r),o=!0;break}return o}}(o||(o={})),"undefined"!=typeof window&&(window.BlazorIntersectionObserverJS=o),t.default=o}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiQmxhem9ySW50ZXJzZWN0aW9uT2JzZXJ2ZXJKUyIsIk9CU0VSVkVSX0lEX1BSRUZJWCIsIk9CU0VSVkVSX0lEIiwib2JzZXJ2ZXJJdGVtcyIsIk1hcCIsImhhc1NhbWVPcHRpb25zIiwiYSIsImIiLCJyb290Iiwicm9vdE1hcmdpbiIsInRocmVzaG9sZCIsImdldE9ic2VydmVySXRlbSIsImRvdG5ldFJlZiIsIm9wdGlvbnMiLCJvYnNlcnZlckl0ZW0iLCJpdGVtRm91bmQiLCJpZCIsImluc3RhbmNlIiwiZ2V0SXRlbUZyb21PcHRpb25zIiwib2JzZXJ2ZXIiLCJJbnRlcnNlY3Rpb25PYnNlcnZlciIsIm9ic2VydmVySW5zdGFuY2VJZCIsImVudHJpZXMiLCJoYXMiLCJlbGVtZW50cyIsIm9ic2VydmVyRW50cmllcyIsInJlZHVjZSIsImJhdGNoZWQiLCJlbnRyeSIsIml0ZW0iLCJ0YXJnZXQiLCJjb25jYXQiLCJrZXlzIiwiZm9yRWFjaCIsIm9ic2VydmVySWQiLCJiYXRjaCIsImludm9rZU1ldGhvZEFzeW5jIiwibWFwIiwidG9FbnRyeU9iamVjdCIsIm9uRW50cnlDaGFuZ2UiLCJzZXQiLCJjbGVhbnVwT2JzZXJ2ZXIiLCJpdGVtSWQiLCJpbnN0YW5jZVJlbW92ZWQiLCJzaXplIiwiZGlzY29ubmVjdCIsImRlbGV0ZSIsInRvUmVjdFJlYWRPbmx5T2JqZWN0Iiwib2JqIiwiWCIsIngiLCJZIiwieSIsIldpZHRoIiwid2lkdGgiLCJIZWlnaHQiLCJoZWlnaHQiLCJUb3AiLCJ0b3AiLCJMZWZ0IiwibGVmdCIsIkJvdHRvbSIsImJvdHRvbSIsIlJpZ2h0IiwicmlnaHQiLCJJc0ludGVyc2VjdGluZyIsImlzSW50ZXJzZWN0aW5nIiwiSW50ZXJzZWN0aW9uUmF0aW8iLCJpbnRlcnNlY3Rpb25SYXRpbyIsIlRpbWUiLCJ0aW1lIiwiQm91bmRpbmdDbGllbnRSZWN0IiwiYm91bmRpbmdDbGllbnRSZWN0IiwiSW50ZXJzZWN0aW9uUmVjdCIsImludGVyc2VjdGlvblJlY3QiLCJSb290Qm91bmRzIiwicm9vdEJvdW5kcyIsInJlc2V0IiwiY2xlYXIiLCJnZXRPYnNlcnZlckl0ZW1zIiwiU2V0Iiwib2JzZXJ2ZSIsIm5vZGUiLCJlbGVtZW50Iiwib2JzZXJ2ZXJFbGVtZW50cyIsImFkZCIsIm9ic2VydmVJbnN0YW5jZUVsZW1lbnQiLCJvYnNlcnZlRWxlbWVudCIsImluc3RhbmNlcyIsInZhbHVlcyIsInVub2JzZXJ2ZSIsInJlbW92ZWQiLCJvYnNlcnZlcnMiLCJkaXNjb25uZWN0ZWQiLCJpbnN0YW5jZUlkIiwid2luZG93IiwiZGVmYXVsdCJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixF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RzdDbEMsRUFBQWtJLFFBQWVoRyIsImZpbGUiOiJibGF6b3IuaW50ZXJzZWN0aW9uLW9ic2VydmVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGludGVyZmFjZSBJRG90TmV0T2JqZWN0UmVmIHtcclxuICAgIGludm9rZU1ldGhvZEFzeW5jKG1ldGhvZE5hbWU6IHN0cmluZywgLi4uYXJnczogYW55W10pOiBQcm9taXNlPGFueT47XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJdGVtIHtcclxuICAgIGlkOiBzdHJpbmc7XHJcbiAgICBpbnN0YW5jZTogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbnN0YW5jZTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJbnRlcnNlY3Rpb25PYnNlcnZlckluc3RhbmNlIHtcclxuICAgIGRvdG5ldFJlZjogSURvdE5ldE9iamVjdFJlZjtcclxuICAgIG9ic2VydmVyOiBJbnRlcnNlY3Rpb25PYnNlcnZlcjtcclxuICAgIG9wdGlvbnM6IEludGVyc2VjdGlvbk9ic2VydmVySW5pdDtcclxuICAgIGVsZW1lbnRzOiBNYXA8c3RyaW5nLCBTZXQ8RWxlbWVudD4+O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEVsZW1lbnRJbnN0YW5jZSB7XHJcbiAgICBvYnNlcnZlcnM6IEludGVyc2VjdGlvbk9ic2VydmVySW5zdGFuY2VbXTtcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgT25JbnRlcnNlY3Rpb25VcGRhdGVGbiA9IChlbnRyaWVzOiBJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5W10pID0+IGFueTtcclxuXHJcbm5hbWVzcGFjZSBCbGF6b3JJbnRlcnNlY3Rpb25PYnNlcnZlckpTIHtcclxuXHJcbiAgICBleHBvcnQgY29uc3QgT0JTRVJWRVJfSURfUFJFRklYID0gXCJibGF6b3JfcGx1Z2luX29ic2VydmVyX19cIjtcclxuXHJcbiAgICBsZXQgT0JTRVJWRVJfSUQgPSAxO1xyXG5cclxuICAgIGNvbnN0IG9ic2VydmVySXRlbXMgPSBuZXcgTWFwPHN0cmluZywgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbnN0YW5jZT4oKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0IHRoZSBjb3VudGVyIGFuZCB0aGUgb2JzZXJ2ZXIgaW5zdGFuY2VzXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiByZXNldCgpIHtcclxuICAgICAgICBPQlNFUlZFUl9JRCA9IDE7XHJcbiAgICAgICAgb2JzZXJ2ZXJJdGVtcy5jbGVhcigpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBvYnNlcnZlciBpdGVtc1xyXG4gICAgICovXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gZ2V0T2JzZXJ2ZXJJdGVtcygpIHtcclxuICAgICAgICByZXR1cm4gb2JzZXJ2ZXJJdGVtcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlIGEgdW5pcXVlIGlkIGZvciBhbiBvYnNlcnZlciBpdGVtLiBcclxuICAgICAqKi9cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZU9ic2VydmVySXRlbUlkKCkge1xyXG4gICAgICAgIHJldHVybiBgJHtPQlNFUlZFUl9JRF9QUkVGSVh9JHtPQlNFUlZFUl9JRCsrfWA7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayB3aGV0aGVyIHRoZSB0d28gb3B0aW9ucyBhcmUgdGhlIHNhbWUuXHJcbiAgICAgKiBAcGFyYW0ge0ludGVyc2VjdGlvbk9ic2VydmVySW5pdH0gYSAtIEFuIG9ic2VydmVyJ3Mgb3B0aW9ucyB0byBjb21wYXJlIFxyXG4gICAgICogQHBhcmFtIHtJbnRlcnNlY3Rpb25PYnNlcnZlckluaXR9IGIgLSBBbiBvYnNlcnZlcidzIG9wdGlvbnMgdG8gY29tcGFyZVxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gV2hldGhlciB0aGUgdHdvIG9wdGlvbnMgYXJlIHRoZSBzYW1lXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGhhc1NhbWVPcHRpb25zKGE6IEludGVyc2VjdGlvbk9ic2VydmVySW5pdCwgYjogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbml0KTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgYS5yb290ID09PSBiLnJvb3QgJiZcclxuICAgICAgICAgICAgYS5yb290TWFyZ2luID09PSBiLnJvb3RNYXJnaW4gJiZcclxuICAgICAgICAgICAgYS50aHJlc2hvbGQgPT09IGIudGhyZXNob2xkXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIElmIHRoZXJlJ3MgYW4gZXhpc3Rpbmcgb2JzZXJ2ZXIgaXRlbSwgcmV0cmlldmUgaXQgZ2l2ZW4gdGhlIHNhbWUgb3B0aW9ucy5cclxuICAgICAqIEBwYXJhbSB7SW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbml0fSBvcHRpb25zIC0gVGhlIG9ic2VydmVyIG9wdGlvbnNcclxuICAgICAqIEByZXR1cm5zIHtJbnRlcnNlY3Rpb25PYnNlcnZlckl0ZW0gfCBudWxsfSAtIFRoZSBvYnNlcnZlciBpdGVtIG9yIG5vdGhpbmcgXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdldEl0ZW1Gcm9tT3B0aW9ucyhvcHRpb25zOiBJbnRlcnNlY3Rpb25PYnNlcnZlckluaXQpOiBJbnRlcnNlY3Rpb25PYnNlcnZlckl0ZW0gfCBudWxsIHtcclxuICAgICAgICBsZXQgaXRlbUZvdW5kOiAoSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJdGVtIHwgbnVsbCkgPSBudWxsO1xyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IFtpZCwgaW5zdGFuY2VdIG9mIG9ic2VydmVySXRlbXMpIHtcclxuICAgICAgICAgICAgaWYgKGhhc1NhbWVPcHRpb25zKG9wdGlvbnMsIGluc3RhbmNlLm9wdGlvbnMpKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtRm91bmQgPSB7IGlkLCBpbnN0YW5jZSB9O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBpdGVtRm91bmQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGQgYW4gZWxlbWVudCB0byB0aGUgb2JzZXJ2ZXIgaW5zdGFuY2UuXHJcbiAgICAgKiBAcGFyYW0ge0ludGVyc2VjdGlvbk9ic2VydmVySW5zdGFuY2V9IGluc3RhbmNlIC0gVGhlIG9ic2VydmVyIGluc3RhbmNlXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgZWxlbWVudCB0byBhZGQgdG8gdGhlIGluc3RhbmNlXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb2JzZXJ2ZXJJZCAtIFRoZSBvYnNlcnZlciBpZFxyXG4gICAgICogQHJldHVybnMge0ludGVyc2VjdGlvbk9ic2VydmVySW5zdGFuY2V9IC0gVGhlIG9ic2VydmVyIGluc3RhbmNlXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIG9ic2VydmVJbnN0YW5jZUVsZW1lbnQoaW5zdGFuY2U6IEludGVyc2VjdGlvbk9ic2VydmVySW5zdGFuY2UsIG9ic2VydmVySWQ6IHN0cmluZywgZWxlbWVudDogRWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IHsgZWxlbWVudHMsIG9ic2VydmVyIH0gPSBpbnN0YW5jZTtcclxuICAgICAgICBjb25zdCBvYnNlcnZlckVsZW1lbnRzID0gZWxlbWVudHMuZ2V0KG9ic2VydmVySWQpO1xyXG5cclxuICAgICAgICBpZiAob2JzZXJ2ZXJFbGVtZW50cyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyRWxlbWVudHMuYWRkKGVsZW1lbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnRzLnNldChvYnNlcnZlcklkLCBuZXcgU2V0PEVsZW1lbnQ+KFtlbGVtZW50XSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50KTtcclxuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGUgb3IgdXNlIGFuIGV4aXN0aW5nIGludGVyc2VjdGlvbiBvYnNlcnZlciBpdGVtLlxyXG4gICAgICogQHBhcmFtIHtEb3ROZXRPYmplY3RSZWZ9IGRvdG5ldFJlZiAtIFRoZSBjdXJyZW50IGRvdG5ldCBibGF6b3IgcmVmZXJlbmNlXHJcbiAgICAgKiBAcGFyYW0ge0ludGVyc2VjdGlvbk9ic2VydmVyRW50cnlJbml0fSBvcHRpb25zIC0gVGhlIG9ic2VydmVyIG9wdGlvbnNcclxuICAgICAqIEByZXR1cm5zIHtJbnRlcnNlY3Rpb25PYnNlcnZlckl0ZW19IC0gVGhlIGludGVyc2VjdGlvbiBvYnNlcnZlciBpdGVtXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdldE9ic2VydmVySXRlbShkb3RuZXRSZWY6IElEb3ROZXRPYmplY3RSZWYsIG9wdGlvbnM6IEludGVyc2VjdGlvbk9ic2VydmVySW5pdCk6IEludGVyc2VjdGlvbk9ic2VydmVySXRlbSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBvcHRpb25zID0ge307XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBvYnNlcnZlckl0ZW0gPSBnZXRJdGVtRnJvbU9wdGlvbnMob3B0aW9ucyk7XHJcblxyXG4gICAgICAgIGlmIChvYnNlcnZlckl0ZW0gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zdCBpZCA9IGNyZWF0ZU9ic2VydmVySXRlbUlkKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKG9uRW50cnlDaGFuZ2UoaWQpLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBuZXcgTWFwPHN0cmluZywgU2V0PEVsZW1lbnQ+PigpO1xyXG5cclxuICAgICAgICAgICAgb2JzZXJ2ZXJJdGVtcy5zZXQoaWQsIHsgZG90bmV0UmVmLCBvcHRpb25zLCBvYnNlcnZlciwgZWxlbWVudHMgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogb2JzZXJ2ZXJJdGVtcy5nZXQoaWQpIGFzIEludGVyc2VjdGlvbk9ic2VydmVySW5zdGFuY2VcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBvYnNlcnZlckl0ZW07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGUgYSBpbnRlcnNlY3Rpb24gb2JzZXJ2ZXIuXHJcbiAgICAgKiBAcGFyYW0ge0lEb3ROZXRPYmplY3RSZWZ9IGRvdG5ldFJlZiAtIFRoZSBkb3RuZXQgaW50ZXJvcCByZWZlcmVuY2VcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZCAtIFRoZSBpbnN0YW5jZSBpZCBvZiB0aGUgXCJvYnNlcnZlclwiXHJcbiAgICAgKiBAcGFyYW0ge0ludGVyc2VjdGlvbk9ic2VydmVySW5pdH0gb3B0aW9ucyAtIFRoZSBpbnRlcnNlY3Rpb24gb2JzZXZlciBvcHRpb25zXHJcbiAgICAgKiBAcmV0dXJucyB7SW50ZXJzZWN0aW9uT2JzZXJ2ZXJJdGVtfSAtIFRoZSBvYnNlcnZlciBpdGVtXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBjcmVhdGUoZG90bmV0UmVmOiBJRG90TmV0T2JqZWN0UmVmLCBpZDogc3RyaW5nLCBvcHRpb25zOiBJbnRlcnNlY3Rpb25PYnNlcnZlckluaXQpIHtcclxuICAgICAgY29uc3QgaXRlbSA9IGdldE9ic2VydmVySXRlbShkb3RuZXRSZWYsIG9wdGlvbnMpO1xyXG4gICAgICBjb25zdCB7IGluc3RhbmNlIH0gPSBpdGVtO1xyXG4gICAgICBpbnN0YW5jZS5lbGVtZW50cy5zZXQoaWQsIG5ldyBTZXQ8RWxlbWVudD4oW10pKTtcclxuICAgICAgcmV0dXJuIGl0ZW07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPYnNlcnZlIHRoZSB0YXJnZXQgbm9kZSB1c2luZyBhIG5ldyBvciBleGlzdGluZyBvYnNlcnZlclxyXG4gICAgICogQHBhcmFtIHtJRG90TmV0T2JqZWN0UmVmfSBkb3RuZXRSZWYgLSBUaGUgZG90bmV0IGludGVyb3AgcmVmZXJlbmNlXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSBUaGUgaW5zdGFuY2UgaWQgb2YgdGhlIFwib2JzZXJ2ZXJcIlxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBub2RlIC0gVGhlIG5vZGUgdG8gb2JzZXJ2ZVxyXG4gICAgICogQHBhcmFtIHtJbnRlcnNlY3Rpb25PYnNlcnZlckluaXR9IG9wdGlvbnMgLSBUaGUgaW50ZXJzZWN0aW9uIG9ic2VydmVyIG9wdGlvbnNcclxuICAgICAqIEByZXR1cm5zIHtJbnRlcnNlY3Rpb25PYnNlcnZlckluc3RhbmNlfSAtIFRoZSBvYnNlcnZlciBpbnN0YW5jZVxyXG4gICAgICovXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gb2JzZXJ2ZShkb3RuZXRSZWY6IElEb3ROZXRPYmplY3RSZWYsIGlkOiBzdHJpbmcsIG5vZGU6IEVsZW1lbnQsIG9wdGlvbnM6IEludGVyc2VjdGlvbk9ic2VydmVySW5pdCkge1xyXG4gICAgICAgIGNvbnN0IHsgaW5zdGFuY2UgfSA9IGdldE9ic2VydmVySXRlbShkb3RuZXRSZWYsIG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiBvYnNlcnZlSW5zdGFuY2VFbGVtZW50KGluc3RhbmNlLCBpZCwgbm9kZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPYnNlcnZlIGFuIGVsZW1lbnQgZm9yIHRoZSBvYnNlcnZlciBpbnN0YW5jZS5cclxuICAgICAqIEBwYXJhbSBpZCAtIFRoZSBvYnNlcnZlciBpZFxyXG4gICAgICogQHBhcmFtIGVsZW1lbnQgLSBUaGUgZWxlbWVudCB0byBvYnNlcnZlXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBvYnNlcnZlRWxlbWVudChpZDogc3RyaW5nLCBlbGVtZW50OiBFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2VzID0gb2JzZXJ2ZXJJdGVtcy52YWx1ZXMoKTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBpbnN0YW5jZSBvZiBpbnN0YW5jZXMpIHtcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBpbnN0YW5jZS5lbGVtZW50cy5nZXQoaWQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnRzICE9IG51bGwgJiYgIWVsZW1lbnRzLmhhcyhlbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uub2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnRzLmFkZChlbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIHRoZSBlbGVtZW50IGZyb20gdGhlIG9ic2VydmVyIGluc3RhbmNlIGFuZFxyXG4gICAgICogdW5vYnNlcnZlIHRoZSBlbGVtZW50LlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gVGhlIG9ic2VydmVyIGlkXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgbm9kZSB0byB1bm9ic2VydmVcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFdoZXRoZXIgdGhlIGVsZW1lbnQgaGFzIGJlZW4gdW5vYnNlcnZlZFxyXG4gICAgICovXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gdW5vYnNlcnZlKGlkOiBzdHJpbmcsIGVsZW1lbnQ6IEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBpbnN0YW5jZXMgPSBvYnNlcnZlckl0ZW1zLnZhbHVlcygpO1xyXG4gICAgICAgIGxldCByZW1vdmVkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaW5zdGFuY2Ugb2YgaW5zdGFuY2VzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRzID0gaW5zdGFuY2UuZWxlbWVudHMuZ2V0KGlkKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50cyAhPSBudWxsICYmIGVsZW1lbnRzLmhhcyhlbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uub2JzZXJ2ZXIudW5vYnNlcnZlKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudHMuZGVsZXRlKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlbW92ZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWxldGUgdGhlIGVsZW1lbnRzIGZyb20gdGhlIG9ic2VydmVyIGluc3RhbmNlIFxyXG4gICAgICogYW5kIHRyaWdnZXIgY2xlYW5pbmcgdXAgdGhlIG9ic2VydmVycy5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZCAtIFRoZSBvYnNlcnZlciBpbnN0YW5jZSBpZFxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gV2hldGhlciB0aGUgZWxlbWVudHMgaGF2ZVxyXG4gICAgICogYmVlbiByZW1vdmVkIGZyb20gdGhlIG9ic2VydmVyIGluc3RhbmNlXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBkaXNjb25uZWN0KGlkOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBvYnNlcnZlcnMgPSBvYnNlcnZlckl0ZW1zLmVudHJpZXMoKTtcclxuICAgICAgICBsZXQgZGlzY29ubmVjdGVkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgW2luc3RhbmNlSWQsIGluc3RhbmNlXSBvZiBvYnNlcnZlcnMpIHtcclxuICAgICAgICAgICAgaWYgKGluc3RhbmNlLmVsZW1lbnRzLmdldChpZCkpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmVsZW1lbnRzLmRlbGV0ZShpZCk7XHJcbiAgICAgICAgICAgICAgICBjbGVhbnVwT2JzZXJ2ZXIoaW5zdGFuY2VJZCwgaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgZGlzY29ubmVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZGlzY29ubmVjdGVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSWYgdGhlcmUgYXJlIG5vIGVsZW1lbnRzIGluIHRoZSBvYnNlcnZlclxyXG4gICAgICogaW5zdGFuY2UsIGRpc2Nvbm5lY3QgdGhlIG9ic2VydmVyIGFuZCByZW1vdmVcclxuICAgICAqIGl0IGZyb20gdGhlIG9ic2VydmVyIGluc3RhbmNlcy5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpdGVtSWQgLSBUaGUgb2JzZXJ2ZXIgaXRlbSBpZFxyXG4gICAgICogQHBhcmFtIHtJbnRlcnNlY3Rpb25PYnNlcnZlckluc3RhbmNlfSBpbnN0YW5jZSAtIFRoZSBpbnN0YW5jZSB0byByZW1vdmVcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFdoZXRoZXIgdGhlIGluc3RhbmNlIGhhcyBiZWVuIHJlbW92ZWRcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY2xlYW51cE9ic2VydmVyKGl0ZW1JZDogc3RyaW5nLCBpbnN0YW5jZTogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbnN0YW5jZSkge1xyXG4gICAgICAgIGxldCBpbnN0YW5jZVJlbW92ZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYgKGluc3RhbmNlLmVsZW1lbnRzLnNpemUgPT09IDApIHtcclxuICAgICAgICAgICAgaW5zdGFuY2Uub2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICBvYnNlcnZlckl0ZW1zLmRlbGV0ZShpdGVtSWQpO1xyXG4gICAgICAgICAgICBpbnN0YW5jZVJlbW92ZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlUmVtb3ZlZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgdHJpZ2dlcmVkIHdoZW4gYW5cclxuICAgICAqIGVsZW1lbnQgaGFzIGFuIGludGVyc2VjdGlvbiB1cGRhdGUuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb2JzZXJ2ZXJJbnN0YW5jZUlkIC0gVGhlIGluc3RhbmNlIGlkXHJcbiAgICAgKiBAcmV0dXJucyB7T25JbnRlcnNlY3Rpb25VcGRhdGVGbn0gLSBUaGUgZnVuY3Rpb24gdHJpZ2dlcmVkIGJ5IGFuIGludGVyc2VjdGlvbiB1cGRhdGVcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gb25FbnRyeUNoYW5nZShvYnNlcnZlckluc3RhbmNlSWQ6IHN0cmluZyk6IE9uSW50ZXJzZWN0aW9uVXBkYXRlRm4ge1xyXG4gICAgICAgIHJldHVybiAoZW50cmllczogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeVtdKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghb2JzZXJ2ZXJJdGVtcy5oYXMob2JzZXJ2ZXJJbnN0YW5jZUlkKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCB7IGRvdG5ldFJlZiwgZWxlbWVudHMgfSA9IG9ic2VydmVySXRlbXMuZ2V0KG9ic2VydmVySW5zdGFuY2VJZCkgYXMgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbnN0YW5jZTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG9ic2VydmVyRW50cmllcyA9IGVudHJpZXMucmVkdWNlKChiYXRjaGVkLCBlbnRyeSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbaWQsIGl0ZW1dIG9mIGVsZW1lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uaGFzKGVudHJ5LnRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hlZFtpZF0gPSAoYmF0Y2hlZFtpZF0gfHwgW10pLmNvbmNhdChlbnRyeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJhdGNoZWQ7XHJcbiAgICAgICAgICAgIH0sIHt9KTtcclxuXHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKG9ic2VydmVyRW50cmllcykuZm9yRWFjaCgob2JzZXJ2ZXJJZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYmF0Y2ggPSBvYnNlcnZlckVudHJpZXNbb2JzZXJ2ZXJJZF0gYXMgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeVtdO1xyXG4gICAgICAgICAgICAgICAgZG90bmV0UmVmLmludm9rZU1ldGhvZEFzeW5jKFwiT25DYWxsYmFja1wiLCBvYnNlcnZlcklkLCBiYXRjaC5tYXAodG9FbnRyeU9iamVjdCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0IHRoZSBvYnNlcnZlciBlbnRyeSB0byBhbiBvYmplY3QgdGhhdFxyXG4gICAgICogd2lsbCBiZSBwYXJzZWQgdG8gdGhlIGNhbGxiYWNrLlxyXG4gICAgICogQHBhcmFtIHtJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5fSBlbnRyeSAtIFRoZSBvYnNlcnZlciBlbnRyeVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiB0b0VudHJ5T2JqZWN0KGVudHJ5OiBJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gdG9SZWN0UmVhZE9ubHlPYmplY3Qob2JqOiBET01SZWN0UmVhZE9ubHkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIFg6IG9iai54LFxyXG4gICAgICAgICAgICAgICAgWTogb2JqLnksXHJcbiAgICAgICAgICAgICAgICBXaWR0aDogb2JqLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgSGVpZ2h0OiBvYmouaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgVG9wOiBvYmoudG9wLFxyXG4gICAgICAgICAgICAgICAgTGVmdDogb2JqLmxlZnQsXHJcbiAgICAgICAgICAgICAgICBCb3R0b206IG9iai5ib3R0b20sXHJcbiAgICAgICAgICAgICAgICBSaWdodDogb2JqLnJpZ2h0XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAvLyBET00tRWxlbWVudCBjYW4ndCBiZSBzZXJpYWxpemVkIHRvIFNlcnZlci1TaWRlLUJsYXpvcjogVGFyZ2V0OiBlbnRyeS50YXJnZXQsXHJcbiAgICAgICAgICAgIElzSW50ZXJzZWN0aW5nOiBlbnRyeS5pc0ludGVyc2VjdGluZyxcclxuICAgICAgICAgICAgSW50ZXJzZWN0aW9uUmF0aW86IGVudHJ5LmludGVyc2VjdGlvblJhdGlvLFxyXG4gICAgICAgICAgICBUaW1lOiBlbnRyeS50aW1lLFxyXG4gICAgICAgICAgICBCb3VuZGluZ0NsaWVudFJlY3Q6IHRvUmVjdFJlYWRPbmx5T2JqZWN0KGVudHJ5LmJvdW5kaW5nQ2xpZW50UmVjdCBhcyBET01SZWN0UmVhZE9ubHkpLFxyXG4gICAgICAgICAgICBJbnRlcnNlY3Rpb25SZWN0OiB0b1JlY3RSZWFkT25seU9iamVjdChlbnRyeS5pbnRlcnNlY3Rpb25SZWN0IGFzIERPTVJlY3RSZWFkT25seSksXHJcbiAgICAgICAgICAgIFJvb3RCb3VuZHM6IHRvUmVjdFJlYWRPbmx5T2JqZWN0KGVudHJ5LnJvb3RCb3VuZHMgYXMgRE9NUmVjdFJlYWRPbmx5KVxyXG4gICAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG5cclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgIHdpbmRvd1tcIkJsYXpvckludGVyc2VjdGlvbk9ic2VydmVySlNcIl0gPSBCbGF6b3JJbnRlcnNlY3Rpb25PYnNlcnZlckpTO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBCbGF6b3JJbnRlcnNlY3Rpb25PYnNlcnZlckpTO1xyXG4iXSwic291cmNlUm9vdCI6IiJ9